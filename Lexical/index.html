<html>
	<head>
		<title>Lexical analyer by netcan</title>
		<link href="http://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
		<script src="http://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
		<script src="http://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<style>#forkongithub a{background:#000;color:#fff;text-decoration:none;font-family:arial,sans-serif;text-align:center;font-weight:bold;padding:5px 40px;font-size:1rem;line-height:2rem;position:relative;transition:0.5s;}#forkongithub a:hover{background:#c11;color:#fff;}#forkongithub a::before,#forkongithub a::after{content:"";width:100%;display:block;position:absolute;top:1px;left:0;height:1px;background:#fff;}#forkongithub a::after{bottom:1px;top:auto;}@media screen and (min-width:800px){#forkongithub{position:fixed;display:block;top:0;right:0;width:200px;overflow:hidden;height:200px;z-index:9999;}#forkongithub a{width:200px;position:absolute;top:42px;right:-42px;transform:rotate(45deg);-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);-moz-transform:rotate(45deg);-o-transform:rotate(45deg);box-shadow:4px 4px 10px rgba(0,0,0,0.8);}}</style><span id="forkongithub">
	</head>
	<body>
		<a href="https://github.com/netcan/compilingTheory" target="_blank">Fork me on GitHub</a></span>
		<div class="container-fluid">
			<h1>Lexical analyer by netcan</h1>
			<div class="row">
				<div class="col-md-6">
					<div class="form-group">
						<label for="indata">输入文本</label>
						<textarea class="form-control" id="indata" name="indata" rows=10 cols=100></textarea>
					</div>
				</div>
				<div class="col-md-6">
					<div class="panel panel-info">
						<div class="panel-heading">Lexical analyer output</div>
						<div class="panel-body">
							<table class="table table-hover">
								<thead>
									<tr>
										<th>#</th>
										<th>Word</th>
										<th>Tuple</th>
										<th>Type</th>
										<th>Position</th>
									</tr>
								</thead>
								<tbody id="out">

								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>

			<!-- <button class="btn btn-info" id="submit">提交</button> -->
		</div>

		<script>
			function update() {
				$.ajax({
					url: "lexical.php",
					dataType: "json",
					method: "POST",
					data: {indata: $('#indata').val()},
					success: function(data, status, jqxhr) {
						var first = 0;
						if(data.length == 0)
							$('#out').html('');
						data.forEach(function(entry){
							if(first == 0) {
								if(entry["type"] == "ERROR") {
									$('#out').html("<tr class='danger'><td>"+first+"</td><td>"+entry["word"]+
											"</td><td>("+entry["tuple"][0]+", "+entry["tuple"][1]+")</td><td>"+
											entry["type"] + "</td><td>(" + entry["pos"][0] + ", " + entry["pos"][1] + ")</td></tr>"
											);
								}
								else
									$('#out').html("<tr><td>"+first+"</td><td>"+entry["word"]+
											"</td><td>("+entry["tuple"][0]+", "+entry["tuple"][1]+")</td><td>"+
											entry["type"] + "</td><td>(" + entry["pos"][0] + ", " + entry["pos"][1] + ")</td></tr>"
											);
							}
							else {
								if(entry["type"] == "ERROR") {
									$('#out').append("<tr class='danger'><td>"+first+"</td><td>"+entry["word"]+
											"</td><td>("+entry["tuple"][0]+", "+entry["tuple"][1]+")</td><td>"+
											entry["type"] + "</td><td>(" + entry["pos"][0] + ", " + entry["pos"][1] + ")</td></tr>"
											);
								}
								else
									$('#out').append("<tr><td>"+first+"</td><td>"+entry["word"]+
											"</td><td>("+entry["tuple"][0]+", "+entry["tuple"][1]+")</td><td>"+
											entry["type"] + "</td><td>(" + entry["pos"][0] + ", " + entry["pos"][1] + ")</td></tr>"
											);
							}
							++first;
						});
					}
				});
			}

			$('textarea').on('change keyup paste', update);

			$('textarea').val(
					"int a = 2, b = 3;\n" +
					'"this isn\'t a string\n'+
					'printf("c=%d\\n", (a+b)/2);'
					);
			update();
		</script>
	</body>
</html>
